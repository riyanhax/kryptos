<html>
<head>
<meta id='metaFileNameId' name='id' content='51519' />
<title>Tutorial 3: Create a Custom Node Type</title>
<link type='text/css' href='xstyle.css' rel='stylesheet' media='all' />
<script src='script.js' language='javascript' type='text/javascript'> </script>
<script src='common.js' language='javascript' type='text/javascript'> </script>
<xml>
<MSHelp:Attr Name="Product" Value="JsDiagram">
</xml>
</head>
<body style='margin: 0;'>
<img src='collapse.png' title='Collapse Section' id='collapseImage' style='display: none; height: 0; width: 0;' /><img src='expand.png' title='Expand Section' id='expandImage' style='display: none; height: 0; width: 0;' /><img src='collapsesmall.png' title='Collapse All' id='collapseAllImage' style='display: none; height: 0; width: 0;' /><img src='expandsmall.png' title='Expand All' id='expandAllImage' style='display: none; height: 0; width: 0;' /><input type="hidden" id="userDataCache" class="userDataStyle"><img src='arrow.png' title='DropDown image' id='dropDownImage' style='display: none; height: 0; width: 0;' /><img src='arrowh.png' title='DropDown image' id='dropDownHoverImage' style='display: none; height: 0; width: 0;' /><img src='copycode.png' title='Copy Code' id='copyCodeImage' style='display: none; height: 0; width: 0;' /><img src='copycodeh.png' title='Copy Code' id='copyCodeHoverImage' style='display: none; height: 0; width: 0;' /><div id='nsbanner'>
<table class='bannerparthead' cellspacing='0'>
<tr>
<td><span class='gtitle'>MindFusion.Diagramming for JavaScript Programmer's Guide</span></td>
</tr>
<tr>
<td style='border-bottom: solid 1px #C8CDDE;'><span class='title'>Tutorial 3: Create a Custom Node Type</span></td>
</tr>
</table>
</div>
<div id='nstext'>
<p>This tutorial shows how to define a custom node class that adds several new properties and graphics elements through a template.</p><p>1. Create empty Tutorial3.html and Tutorial3.js files, and add DIV and CANVAS elements to the HTML page.</p><p><table class='syntax' cellspacing='0'><tr><th><span style='float: left;'>HTML</span>
<span class='copyCode' onclick='CopyCode(this);' onkeypress='CopyCode_CheckKey(this);' onmouseover='ChangeCopyCodeIcon(this, true);' onmouseout='ChangeCopyCodeIcon(this, false);'>
<img src='copycode.png' title='Copy Code' style='border-width: 0;' />&#160;Copy Code</span>
</th></tr><tr><td><span class="codeComment">&lt;!-- The Diagram component is bound to the canvas element below --&gt;</span><br/><span class="codeXamlDelimiter">&lt;</span><span class="codeXamlTag">div</span> <span class="codeXamlAttributeName">style</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"width: 900px; height: 500px; overflow: auto; border: 1px solid;"</span><span class="codeXamlDelimiter">&gt;</span><br/><br/><span class="codeXamlDelimiter">&lt;</span><span class="codeXamlTag">canvas</span> <span class="codeXamlAttributeName">id</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"diagram"</span> <span class="codeXamlAttributeName">width</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"2100"</span> <span class="codeXamlAttributeName">height</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"2100"</span><span class="codeXamlDelimiter">&gt;</span><br/>&#160;&#160;&#160; <span class="codeXamlAttributeName">This</span> <span class="codeXamlAttributeName">page</span> <span class="codeXamlAttributeName">requires</span> <span class="codeXamlAttributeName">a</span> <span class="codeXamlAttributeName">browser</span> <span class="codeXamlAttributeName">that</span> <span class="codeXamlAttributeName">supports</span> <span class="codeXamlAttributeName">HTML</span> 5 <span class="codeXamlAttributeName">Canvas</span> <span class="codeXamlAttributeName">element</span>.<br/><span class="codeXamlDelimiter">&lt;/</span><span class="codeXamlTag">canvas</span><span class="codeXamlDelimiter">&gt;</span><br/><br/><span class="codeXamlDelimiter">&lt;/</span><span class="codeXamlTag">div</span><span class="codeXamlDelimiter">&gt;</span></td></tr></table></p><p></p><p>2. Add script references to the JQuery, MindFusion.Common, MindFusion.Diagramming and Tutorial3 JavaScript files:</p><p><table class='syntax' cellspacing='0'><tr><th><span style='float: left;'>HTML</span>
<span class='copyCode' onclick='CopyCode(this);' onkeypress='CopyCode_CheckKey(this);' onmouseover='ChangeCopyCodeIcon(this, true);' onmouseout='ChangeCopyCodeIcon(this, false);'>
<img src='copycode.png' title='Copy Code' style='border-width: 0;' />&#160;Copy Code</span>
</th></tr><tr><td><span class="codeXamlDelimiter">&lt;</span><span class="codeXamlTag">script</span> <span class="codeXamlAttributeName">src</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"jquery.min.js"</span> <span class="codeXamlAttributeName">type</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"text/javascript"</span><span class="codeXamlDelimiter">&gt;</span><span class="codeXamlDelimiter">&lt;/</span><span class="codeXamlTag">script</span><span class="codeXamlDelimiter">&gt;</span><br/><span class="codeXamlDelimiter">&lt;</span><span class="codeXamlTag">script</span> <span class="codeXamlAttributeName">src</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"MindFusion.Common.js"</span> <span class="codeXamlAttributeName">type</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"text/javascript"</span><span class="codeXamlDelimiter">&gt;</span><span class="codeXamlDelimiter">&lt;/</span><span class="codeXamlTag">script</span><span class="codeXamlDelimiter">&gt;</span><br/><span class="codeXamlDelimiter">&lt;</span><span class="codeXamlTag">script</span> <span class="codeXamlAttributeName">src</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"MindFusion.Diagramming.js"</span> <span class="codeXamlAttributeName">type</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"text/javascript"</span><span class="codeXamlDelimiter">&gt;</span><span class="codeXamlDelimiter">&lt;/</span><span class="codeXamlTag">script</span><span class="codeXamlDelimiter">&gt;</span><br/><span class="codeXamlDelimiter">&lt;</span><span class="codeXamlTag">script</span> <span class="codeXamlAttributeName">src</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"Tutorial3.js"</span> <span class="codeXamlAttributeName">type</span><span class="codeXamlDelimiter">=</span><span class="codeXamlAttributeValue">"text/javascript"</span><span class="codeXamlDelimiter">&gt;</span><span class="codeXamlDelimiter">&lt;/</span><span class="codeXamlTag">script</span><span class="codeXamlDelimiter">&gt;</span></td></tr></table></p><p>3. In Tutorial3.js, assign shorter names to the <a id='32377' href='CC_T_MindFusion_Diagramming_Diagram_0.htm' title=''>Diagram</a>, <a id='57993' href='T_MindFusion_Diagramming_CompositeNode_0.htm' title=''>CompositeNode</a>,&#160;<a id='37983' href='CC_T_MindFusion_Diagramming_Behavior_0.htm' title=''>Behavior</a>, <a id='32256' href='T_MindFusion_Diagramming_Alignment.htm' title=''>Alignment</a> and&#160;<a id='32547' href='T_MindFusion_Drawing_Rect.htm' title=''>Rect</a> types.</p><p><table class='syntax' codeLanguage='JavaScript' cellspacing='0'><tr><th><span style='float: left;'>JavaScript</span>
<span class='copyCode' onclick='CopyCode(this);' onkeypress='CopyCode_CheckKey(this);' onmouseover='ChangeCopyCodeIcon(this, true);' onmouseout='ChangeCopyCodeIcon(this, false);'>
<img src='copycode.png' title='Copy Code' style='border-width: 0;' />&#160;Copy Code</span>
</th></tr><tr><td><p><span class="codeKeyword">var</span> Diagram = MindFusion.Diagramming.Diagram;<br/><span class="codeKeyword">var</span> CompositeNode = MindFusion.Diagramming.CompositeNode;<br/><span class="codeKeyword">var</span> Behavior = MindFusion.Diagramming.Behavior;</p><p><span class="codeKeyword">var</span> Alignment = MindFusion.Drawing.Alignment;<br/><span class="codeKeyword">var</span> Rect = MindFusion.Drawing.Rect;</p></td></tr></table></p><p>4. In Tutorial3.js call the <a id='57997' href='M_MindFusion_Diagramming_CompositeNode_classFromTemplate_2_String_Object.htm' title=''>classFromTemplate</a>&#160;static method&#160;of CompositeNode to generate a node class from a template. The template is defined through an&#160;object literal that lists layout containers and graphics primitives from which a node should be composed.</p><p><table class='syntax' codeLanguage='JavaScript' cellspacing='0'><tr><th><span style='float: left;'>JavaScript</span>
<span class='copyCode' onclick='CopyCode(this);' onkeypress='CopyCode_CheckKey(this);' onmouseover='ChangeCopyCodeIcon(this, true);' onmouseout='ChangeCopyCodeIcon(this, false);'>
<img src='copycode.png' title='Copy Code' style='border-width: 0;' />&#160;Copy Code</span>
</th></tr><tr><td><p><span class="codeKeyword">var</span> OrgChartNode = CompositeNode.classFromTemplate(<span class="codeString">"OrgChartNode"</span>,<br/>{<br/>&#160;&#160;&#160; component: <span class="codeString">"GridPanel"</span>,<br/>&#160;&#160;&#160; rowDefinitions: [<span class="codeString">"*"</span>],<br/>&#160;&#160;&#160; columnDefinitions: [<span class="codeString">"22"</span>, <span class="codeString">"*"</span>],<br/>&#160;&#160;&#160; children:<br/>&#160;&#160;&#160; [<br/>&#160;&#160;&#160; &#160;&#160;&#160; {<br/>&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; component: <span class="codeString">"Rect"</span>,<br/>&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; name: <span class="codeString">"Background"</span>,<br/>&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; pen: <span class="codeString">"black"</span>,<br/>&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; brush: <span class="codeString">"white"</span>,<br/>&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; columnSpan: <span class="codeNumber">2</span><br/>&#160;&#160;&#160; &#160;&#160;&#160; },<br/>&#160;&#160;&#160; &#160;&#160;&#160; {<br/>&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; component: <span class="codeString">"Image"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; name: <span class="codeString">"Image"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; autoProperty: <span class="codeKeyword">true</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; location: <span class="codeString">"ceo.png"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; margin: <span class="codeString">"1"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; imageAlign: <span class="codeString">"Fit"</span><br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;},<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; component: <span class="codeString">"StackPanel"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; orientation: <span class="codeString">"Vertical"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; gridColumn: <span class="codeNumber">1</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; margin: <span class="codeString">"1"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; verticalAlignment: <span class="codeString">"Near"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; children:<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; component: <span class="codeString">"Text"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; name: <span class="codeString">"Title"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; autoProperty: <span class="codeKeyword">true</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text: <span class="codeString">"title"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; font: <span class="codeString">"Arial bold"</span><br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;},<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; component: <span class="codeString">"Text"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; name: <span class="codeString">"FullName"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; autoProperty: <span class="codeKeyword">true</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text: <span class="codeString">"full name"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pen: <span class="codeString">"blue"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; padding: <span class="codeString">"1,0,1,0"</span><br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;},<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;{<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; component: <span class="codeString">"Text"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; name: <span class="codeString">"Details"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; autoProperty: <span class="codeKeyword">true</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; text: <span class="codeString">"details"</span>,<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; font: <span class="codeString">"Arial 3"</span><br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;]<br/>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;}<br/>&#160;&#160;&#160;&#160;]<br/>});</p></td></tr></table></p><p>5. Create a <span class='repeatingLink'>Diagram</span> instance wrapping the HTML Canvas element. Add&#160;some nodes of the new class and&#160;create links&#160;between them. The <b>autoProperty</b> attribute in template above will generate setter methods for properties&#160;whose name is specified via <b>name</b> attribute.</p><p><table class='syntax' codeLanguage='JavaScript' cellspacing='0'><tr><th><span style='float: left;'>JavaScript</span>
<span class='copyCode' onclick='CopyCode(this);' onkeypress='CopyCode_CheckKey(this);' onmouseover='ChangeCopyCodeIcon(this, true);' onmouseout='ChangeCopyCodeIcon(this, false);'>
<img src='copycode.png' title='Copy Code' style='border-width: 0;' />&#160;Copy Code</span>
</th></tr><tr><td><p><span class="codeKeyword">var</span> diagram = <span class="codeKeyword">null</span>;</p><p>$(document).ready(<span class="codeKeyword">function</span> ()<br/>{<br/>&#160;&#160;&#160; <span class="codeComment">// create a Diagram component that wraps the "diagram" canvas</span><br/>&#160;&#160;&#160; diagram = Diagram.create($(<span class="codeString">"#diagram"</span>)[<span class="codeNumber">0</span>]);<br/><br/>&#160;&#160;&#160; <span class="codeComment">// enable drawing of custom nodes interactively</span><br/>&#160;&#160;&#160; diagram.setCustomNodeType(OrgChartNode);<br/>&#160;&#160;&#160; diagram.setBehavior(Behavior.Custom);<br/><br/>&#160;&#160;&#160; <span class="codeKeyword">var</span> node1 = <span class="codeKeyword">new</span> OrgChartNode(diagram);<br/>&#160;&#160;&#160; node1.setBounds(<span class="codeKeyword">new</span> Rect(<span class="codeNumber">25</span>, <span class="codeNumber">15</span>, <span class="codeNumber">60</span>, <span class="codeNumber">25</span>));<br/>&#160;&#160;&#160; node1.setTitle(<span class="codeString">"CEO"</span>);<br/>&#160;&#160;&#160; node1.setFullName(<span class="codeString">"John Smith"</span>);<br/>&#160;&#160;&#160; node1.setDetails(<br/>&#160;&#160;&#160; &#160;&#160;&#160; <span class="codeString">"Our beloved leader. \r\n"</span> +<br/>&#160;&#160;&#160; &#160;&#160;&#160; <span class="codeString">"The CEO of this great corporation."</span>);<br/>&#160;&#160;&#160; node1.setImage(<span class="codeString">"ceo.png"</span>);<br/>&#160;&#160;&#160; diagram.addItem(node1);</p><p>&#160;&#160;&#160; <span class="codeKeyword">var</span> node2 = <span class="codeKeyword">new</span> OrgChartNode(diagram);<br/>&#160;&#160;&#160; node2.setBounds(<span class="codeKeyword">new</span> Rect(<span class="codeNumber">25</span>, <span class="codeNumber">55</span>, <span class="codeNumber">60</span>, <span class="codeNumber">25</span>));<br/>&#160;&#160;&#160; node2.setTitle(<span class="codeString">"CTO"</span>);<br/>&#160;&#160;&#160; node2.setFullName(<span class="codeString">"Bob Smith"</span>);<br/>&#160;&#160;&#160; node2.setDetails(<span class="codeString">"The technology chief of this great corporation."</span>);<br/>&#160;&#160;&#160; node2.setImage(<span class="codeString">"cto.png"</span>);<br/>&#160;&#160;&#160; diagram.addItem(node2);<br/><br/>&#160;&#160;&#160; <span class="codeComment">// ...</span><br/><br/>&#160;&#160;&#160; diagram.getFactory().createDiagramLink(node1, node2);<br/>});</p></td></tr></table></p><p>6. Publish JQuery.js, MindFusion.Diagramming.js and the tutorial files using web server of your choice. Now you should see this if you open Tutorial3.html in a web browser:</p><p><img src='composite_nodes_js.png' title='' hspace='0' vspace='0' align='' width='527' height='291'/></p>
</div>
<div id='nsfooter'>
<table class='footer' cellspacing='0'>
<tr>
<td valign='middle'>
<span class='copyright'>© 2017 MindFusion</span>
</td>
</tr>
</table>
</div>
</body>
</html>
